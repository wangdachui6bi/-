{"version":3,"sources":["webpack:///./src/api/DiscoverMusic/PersonalRecom.js","webpack:///./src/views/HistoryPlay/index.vue?c2d6","webpack:///./src/views/HistoryPlay/index.vue?8832","webpack:///src/views/HistoryPlay/index.vue","webpack:///./src/views/HistoryPlay/index.vue?b8db","webpack:///./src/views/HistoryPlay/index.vue"],"names":["getBanner","request","getPersonalized","limit","method","url","getRecommend","getPlayListDetail","id","getLikeIdList","uid","likeMusic","like","getHotComment","type","getNewComment","page","before","offset","getSuberList","render","_vm","this","_h","$createElement","_c","_self","staticClass","_v","_s","count","_m","on","playHistorySong","attrs","loading","_e","staticStyle","hislistSongMsg","getOneSong","scopedSlots","_u","key","fn","scope","$event","row","songName","fee","mv","$router","push","staticRenderFns","name","data","tableData","isListenId","likeIdList","methods","$store","commit","songDetail","songMsg","dispatch","state","isPlay","changHistoryList","hisAll","JSON","length","res","isLiked","indexOf","item","created","computed","login","profile","userId","component"],"mappings":"8bAGaA,EAAY,kBAAMC,eAAQ,YAG1BC,EAAkB,SAACC,GAC9B,OAAOF,eAAQ,CACbG,OAAQ,MACRC,IAAK,uBAAF,OAAyBF,MAKnBG,EAAe,kBAAML,eAAQ,wBAI7BM,EAAoB,SAACC,GAChC,OAAOP,eAAQ,CACbG,OAAQ,MACRC,IAAK,uBAAF,OAAyBG,MAKnBC,EAAgB,SAACC,GAC5B,OAAOT,eAAQ,CACbG,OAAQ,MACRC,IAAK,gBAAF,OAAkBK,MAKZC,EAAY,SAACH,EAAII,GAC5B,OAAOX,eAAQ,CACbG,OAAQ,MACRC,IAAK,YAAF,OAAcG,EAAd,iBAAyBI,MAKnBC,EAAgB,SAACL,EAAIM,EAAMX,GACtC,OAAOF,eAAQ,CACbG,OAAQ,MACRC,IAAK,mBAAF,OAAqBG,EAArB,iBAAgCM,EAAhC,kBAA8CX,MAKxCY,EAAgB,SAAC,GAA6C,IAA3CP,EAA2C,EAA3CA,GAA2C,IAAvCL,aAAuC,MAA/B,GAA+B,MAA3Ba,YAA2B,MAApB,EAAoB,MAAjBC,cAAiB,MAAR,EAAQ,EACnEC,EAASF,EAAOb,EACtB,OAAOF,eAAQ,CACbG,OAAQ,MACRC,IAAK,wBAAF,OAA0BG,EAA1B,kBAAsCL,EAAtC,mBAAsDe,EAAtD,mBAAuED,MAKjEE,EAAe,SAAC,GAAiC,IAA/BX,EAA+B,EAA/BA,GAA+B,IAA3BL,aAA2B,MAAnB,GAAmB,MAAfa,YAAe,MAAR,EAAQ,EACtDE,EAASF,EAAOb,EACtB,OAAOF,eAAQ,CACbG,OAAQ,MACRC,IAAK,4BAAF,OAA8BG,EAA9B,kBAA0CL,EAA1C,mBAA0De,O,2DC/DjE,W,yCCAA,IAAIE,EAAS,WAAa,IAAIC,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAG,MAAM,CAACE,YAAY,iCAAiC,CAACF,EAAG,MAAM,CAACE,YAAY,QAAQ,CAACF,EAAG,MAAM,CAACA,EAAG,OAAO,CAACE,YAAY,qBAAqB,CAACN,EAAIO,GAAG,UAAUH,EAAG,OAAO,CAACE,YAAY,oBAAoB,CAACN,EAAIO,GAAG,KAAKP,EAAIQ,GAAGR,EAAIS,OAAO,UAAUT,EAAIU,GAAG,KAAKN,EAAG,MAAM,CAACE,YAAY,oBAAoB,CAACF,EAAG,SAAS,CAACE,YAAY,cAAcK,GAAG,CAAC,MAAQX,EAAIY,kBAAkB,CAACR,EAAG,IAAI,CAACE,YAAY,yBAAyBN,EAAIO,GAAG,cAAcH,EAAG,MAAM,CAACE,YAAY,qBAAqBF,EAAG,cAAc,CAACS,MAAM,CAAC,KAAO,EAAE,SAAW,GAAG,QAAUb,EAAIc,UAAU,CAAGd,EAAIc,QAAwoCd,EAAIe,KAAnoC,CAACX,EAAG,WAAW,CAACY,YAAY,CAAC,MAAQ,QAAQH,MAAM,CAAC,KAAOb,EAAIiB,eAAe,OAAS,IAAIN,GAAG,CAAC,YAAYX,EAAIkB,aAAa,CAACd,EAAG,kBAAkB,CAACS,MAAM,CAAC,KAAO,QAAQ,MAAQ,QAAQT,EAAG,kBAAkB,CAACS,MAAM,CAAC,KAAO,UAAU,MAAQ,MAAMM,YAAYnB,EAAIoB,GAAG,CAAC,CAACC,IAAI,UAAUC,GAAG,SAASC,GAAO,MAAO,CAACnB,EAAG,OAAO,CAACO,GAAG,CAAC,MAAQ,SAASa,GAAQ,OAAOxB,EAAIV,UAAUiC,EAAME,QAAQ,CAACrB,EAAG,MAAM,CAAEmB,EAAME,IAAW,QAAErB,EAAG,IAAI,CAACE,YAAY,uBAAuBU,YAAY,CAAC,MAAQ,SAASZ,EAAG,IAAI,CAACE,YAAY,gCAAgC,MAAK,EAAM,cAAcF,EAAG,kBAAkB,CAACS,MAAM,CAAC,KAAO,WAAW,MAAQ,OAAO,MAAQ,OAAOM,YAAYnB,EAAIoB,GAAG,CAAC,CAACC,IAAI,UAAUC,GAAG,SAASC,GAAO,MAAO,CAACnB,EAAG,OAAO,CAACY,YAAY,CAAC,cAAc,SAAS,CAAChB,EAAIO,GAAGP,EAAIQ,GAAGe,EAAME,IAAIC,aAAgC,IAAlBH,EAAME,IAAIE,IAAWvB,EAAG,MAAM,CAACE,YAAY,WAAW,CAACN,EAAIO,GAAG,SAASP,EAAIe,KAAuB,IAAjBQ,EAAME,IAAIG,GAAUxB,EAAG,MAAM,CAACE,YAAY,UAAUK,GAAG,CAAC,MAAQ,SAASa,GAAQ,OAAOxB,EAAI6B,QAAQC,KAAM,mBAAsBP,EAAME,IAAM,OAAO,CAACzB,EAAIO,GAAG,UAAUP,EAAIe,SAAS,MAAK,EAAM,cAAcX,EAAG,kBAAkB,CAACS,MAAM,CAAC,KAAO,SAAS,MAAQ,KAAK,MAAQ,SAAS,KAAc,IAAI,IAClyDkB,EAAkB,CAAC,WAAa,IAAI/B,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAG,MAAM,CAACE,YAAY,YAAY,CAACF,EAAG,SAAS,CAACE,YAAY,UAAU,CAACN,EAAIO,GAAG,c,kEC2DzK,GACbyB,KAAMA,cACNC,KAFF,WAGI,MAAO,CACLxB,MAAOA,EACPyB,UAAWA,GACXjB,eAAgBA,GAChBkB,YAAaA,EACbC,WAAYA,GACZtB,SAASA,IAIbuB,QAASA,CACPnB,WADJ,SACAO,GACM,GAAIxB,KAAKkC,aAAeV,EAAItC,GAAI,CAE9Bc,KAAKqC,OAAOC,OAAO,wBAAyBd,GAC5CxB,KAAKkC,WAAaV,EAAItC,GAEtB,IAAR,KACQqD,EAAWA,SAAWA,EAAIA,KAC1BA,EAAWA,OAASA,EAAIA,GAAGA,GAAGA,KAC9BA,EAAWA,GAAKA,EAAIA,GACpBA,EAAWA,OAASA,EAAIA,GAAGA,OAC3BvC,KAAKwC,QAAUD,EACfvC,KAAKqC,OAAOI,SAAS,yBAA0BF,QAG1CvC,KAAKqC,OAAOK,MAAMH,WAAWI,QAChC3C,KAAKqC,OAAOC,OAAO,wBAIzBM,iBArBJ,WAqBA,qKACA,aAEA,oBACAC,EAAAC,+CACA,iBALA,SAMA,uBANA,OAOAD,uBACA,SACAN,kBACAA,UACAA,YACAA,sBACAA,UACAA,qBACAA,0BACA,4BAEA,aAlBA,8CAoBI5B,gBAzCJ,WA6CyC,IAA/BX,KAAKgB,eAAe+B,SACxB/C,KAAKqC,OAAOC,OAAO,yBAA0BtC,KAAKgB,gBAClDhB,KAAKqC,OAAOI,SAAS,yBAA0BzC,KAAKgB,eAAe,MAErE7B,cAjDJ,SAiDAC,GAAA,8KACAD,kBADA,OACA6D,EADA,OAEA,wBAFA,8CAIIC,QArDJ,SAqDA/D,GACM,OAAwC,IAAjCc,KAAKmC,WAAWe,QAAQhE,IAEjCG,UAxDJ,SAwDA8D,GAAA,oJACAA,qBADA,SAEA9D,+BAFA,+CAKE+D,QA1EF,WA4EIpD,KAAK4C,oBAEPS,SAAUA,CACRjE,IADJ,WAEM,OAAOY,KAAKqC,OAAOK,MAAMY,MAAMC,QAAQC,UC5IqZ,I,wBCQ9bC,EAAY,eACd,EACA3D,EACAgC,GACA,EACA,KACA,KACA,MAIa,aAAA2B,E","file":"js/chunk-5f8776b6.6cc214ef.js","sourcesContent":["import request from '@/utils/request'\r\n\r\n/* 获取轮播图 */\r\nexport const getBanner = () => request('/banner')\r\n\r\n/* 获取热门歌单 */\r\nexport const getPersonalized = (limit) => {\r\n  return request({\r\n    method: 'get',\r\n    url: `/personalized?limit=${limit}`\r\n  })\r\n}\r\n\r\n/* login 获取个性推荐歌单 */\r\nexport const getRecommend = () => request('/recommend/resource')\r\n\r\n// Date.now()\r\n/* 获取歌单详情 */\r\nexport const getPlayListDetail = (id) => {\r\n  return request({\r\n    method: 'get',\r\n    url: `/playlist/detail?id=${id}`\r\n  })\r\n}\r\n\r\n/* 喜欢音乐列表(调用此接口 , 传入用户 id, 可获取已喜欢音乐 id 列表(id 数组)) */\r\nexport const getLikeIdList = (uid) => {\r\n  return request({\r\n    method: 'get',\r\n    url: `/likelist?id=${uid}`\r\n  })\r\n}\r\n\r\n/* 喜欢的音乐(调用此接口 , 传入音乐 id, 可喜欢该音乐) */\r\nexport const likeMusic = (id, like) => {\r\n  return request({\r\n    method: 'get',\r\n    url: `/like?id=${id}&like=${like}`\r\n  })\r\n}\r\n\r\n/* 热门(精彩)评论,调用此接口 , 传入 type, 资源 id 可获得对应资源热门评论 ( 不需要登录 ) */\r\nexport const getHotComment = (id, type, limit) => {\r\n  return request({\r\n    method: 'get',\r\n    url: `/comment/hot?id=${id}&type=${type}&limit=${limit}`\r\n  })\r\n}\r\n\r\n/* 歌单评论, 调用此接口 , 传入音乐 id 和 limit 参数 , 可获得该歌单的所有评论 ( 不需要 登录 ) */\r\nexport const getNewComment = ({ id, limit = 20, page = 0, before = 0 }) => {\r\n  const offset = page * limit\r\n  return request({\r\n    method: 'get',\r\n    url: `/comment/playlist?id=${id}&limit=${limit}&offset=${offset}&before=${before}`\r\n  })\r\n}\r\n\r\n/* 歌单收藏者,调用此接口 , 传入歌单 id 可获取歌单的所有收藏者 */\r\nexport const getSuberList = ({ id, limit = 30, page = 0 }) => {\r\n  const offset = page * limit\r\n  return request({\r\n    method: 'get',\r\n    url: `/playlist/subscribers?id=${id}&limit=${limit}&offset=${offset}`\r\n  })\r\n}","export * from \"-!../../../node_modules/_mini-css-extract-plugin@0.9.0@mini-css-extract-plugin/dist/loader.js??ref--9-oneOf-1-0!../../../node_modules/_css-loader@3.6.0@css-loader/dist/cjs.js??ref--9-oneOf-1-1!../../../node_modules/_vue-loader@15.9.8@vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/_postcss-loader@3.0.0@postcss-loader/src/index.js??ref--9-oneOf-1-2!../../../node_modules/_sass-loader@9.0.3@sass-loader/dist/cjs.js??ref--9-oneOf-1-3!../../../node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/_vue-loader@15.9.8@vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=style&index=0&lang=scss&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"HistoryPlay view-main mtop-20\"},[_c('div',{staticClass:\"info\"},[_c('div',[_c('span',{staticClass:\"font-24 font-bold\"},[_vm._v(\"最近播放\")]),_c('span',{staticClass:\"font-14 mleft-10\"},[_vm._v(\"共 \"+_vm._s(_vm.count)+\" 首\")])]),_vm._m(0)]),_c('div',{staticClass:\"btn-wrap mtop-10\"},[_c('button',{staticClass:\"btn btn-red\",on:{\"click\":_vm.playHistorySong}},[_c('i',{staticClass:\"iconfont icon-bofang\"}),_vm._v(\" 播放全部 \")])]),_c('div',{staticClass:\"div-line mtop-20\"}),_c('el-skeleton',{attrs:{\"rows\":6,\"animated\":\"\",\"loading\":_vm.loading}},[(!_vm.loading)?[_c('el-table',{staticStyle:{\"width\":\"100%\"},attrs:{\"data\":_vm.hislistSongMsg,\"stripe\":\"\"},on:{\"row-click\":_vm.getOneSong}},[_c('el-table-column',{attrs:{\"type\":\"index\",\"width\":\"50\"}}),_c('el-table-column',{attrs:{\"prop\":\"favicon\",\"width\":\"30\"},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return [_c('span',{on:{\"click\":function($event){return _vm.likeMusic(scope.row)}}},[_c('div',[(scope.row.isLiked)?_c('i',{staticClass:\"iconfont icon-aixin1\",staticStyle:{\"color\":\"red\"}}):_c('i',{staticClass:\"iconfont icon-aixin\"})])])]}}],null,false,3112678245)}),_c('el-table-column',{attrs:{\"prop\":\"songName\",\"label\":\"音乐标题\",\"width\":\"211\"},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return [_c('span',{staticStyle:{\"margin-left\":\"10px\"}},[_vm._v(_vm._s(scope.row.songName))]),(scope.row.fee === 1)?_c('div',{staticClass:\"vip-tag\"},[_vm._v(\"VIP\")]):_vm._e(),(scope.row.mv !== 0)?_c('div',{staticClass:\"vip-tag\",on:{\"click\":function($event){return _vm.$router.push((\"/videodetail/mv/\" + (scope.row.mv)))}}},[_vm._v(\" MV \")]):_vm._e()]}}],null,false,1602777203)}),_c('el-table-column',{attrs:{\"prop\":\"singer\",\"label\":\"歌手\",\"width\":\"80\"}})],1)]:_vm._e()],2)],1)}\nvar staticRenderFns = [function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"btn-wrap\"},[_c('button',{staticClass:\"no-btn\"},[_vm._v(\"清除列表\")])])}]\n\nexport { render, staticRenderFns }","<template>\r\n  <div class=\"HistoryPlay view-main mtop-20\">\r\n    <div class=\"info\">\r\n      <div>\r\n        <span class=\"font-24 font-bold\">最近播放</span>\r\n        <span class=\"font-14 mleft-10\">共 {{ count }} 首</span>\r\n      </div>\r\n      <div class=\"btn-wrap\">\r\n        <button class=\"no-btn\">清除列表</button>\r\n      </div>\r\n    </div>\r\n    <div class=\"btn-wrap mtop-10\">\r\n      <button class=\"btn btn-red\" @click=\"playHistorySong\">\r\n        <i class=\"iconfont icon-bofang\"></i>\r\n        播放全部\r\n      </button>\r\n    </div>\r\n    <div class=\"div-line mtop-20\"></div>\r\n    <el-skeleton :rows=\"6\" animated :loading=\"loading\">\r\n      <template v-if=\"!loading\">\r\n        <el-table :data=\"hislistSongMsg\" style=\"width: 100%\" stripe @row-click=\"getOneSong\">\r\n          <el-table-column type=\"index\" width=\"50\"> </el-table-column>\r\n          <el-table-column prop=\"favicon\" width=\"30\">\r\n            <template slot-scope=\"scope\">\r\n              <span @click=\"likeMusic(scope.row)\">\r\n                <div>\r\n                  <i\r\n                    v-if=\"scope.row.isLiked\"\r\n                    style=\"color: red\"\r\n                    class=\"iconfont icon-aixin1\"\r\n                  ></i>\r\n                  <i v-else class=\"iconfont icon-aixin\"></i>\r\n                </div>\r\n              </span>\r\n            </template>\r\n          </el-table-column>\r\n          <el-table-column prop=\"songName\" label=\"音乐标题\" width=\"211\">\r\n            <template slot-scope=\"scope\">\r\n              <span style=\"margin-left: 10px\">{{ scope.row.songName }}</span>\r\n              <div class=\"vip-tag\" v-if=\"scope.row.fee === 1\">VIP</div>\r\n              <div\r\n                class=\"vip-tag\"\r\n                v-if=\"scope.row.mv !== 0\"\r\n                @click=\"$router.push(`/videodetail/mv/${scope.row.mv}`)\"\r\n              >\r\n                MV\r\n              </div>\r\n            </template>\r\n          </el-table-column>\r\n          <el-table-column prop=\"singer\" label=\"歌手\" width=\"80\">\r\n          </el-table-column>\r\n        </el-table>\r\n      </template>\r\n    </el-skeleton>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { getLikeIdList, likeMusic } from '@/api/DiscoverMusic/PersonalRecom'\r\n// 最近播放\r\nexport default {\r\n  name: \"HistoryPlay\",\r\n  data () {\r\n    return {\r\n      count: 0,\r\n      tableData: [],\r\n      hislistSongMsg: [],\r\n      isListenId: -1,\r\n      likeIdList: [],\r\n      loading: true\r\n    }\r\n  },\r\n\r\n  methods: {\r\n    getOneSong (row) {\r\n      if (this.isListenId !== row.id) {\r\n        // console.log(row)\r\n        this.$store.commit('songDetail/songAllMsg', row)\r\n        this.isListenId = row.id\r\n        // 响应式的数据\r\n        const songDetail = {}\r\n        songDetail.songName = row.name\r\n        songDetail.singer = row.ar[0].name\r\n        songDetail.id = row.id\r\n        songDetail.picUrl = row.al.picUrl\r\n        this.songMsg = songDetail\r\n        this.$store.dispatch('songDetail/getoneMusic', songDetail)\r\n        // this.$store.commit('songDetail/setplayListTracks', row)\r\n      } else {\r\n        if (!this.$store.state.songDetail.isPlay) {\r\n          this.$store.commit(\"songDetail/playback\")\r\n        }\r\n      }\r\n    },\r\n    async changHistoryList () {\r\n      this.loading = true\r\n      // 获取存储在本地的最近播放的列表\r\n      this.hislistSongMsg = []\r\n      const hisAll = JSON.parse(localStorage.historyplayList || '[]')\r\n      this.count = hisAll.length\r\n      await this.getLikeIdList(this.uid)\r\n      hisAll.forEach((item) => {\r\n        const songDetail = {}\r\n        songDetail.songName = item.name\r\n        songDetail.mv = item.mv\r\n        songDetail.fee = item.fee\r\n        songDetail.singer = item.ar[0].name\r\n        songDetail.id = item.id\r\n        songDetail.picUrl = item.al.picUrl\r\n        songDetail.isLiked = this.isLiked(item.id)\r\n        this.hislistSongMsg.push(songDetail)\r\n      })\r\n      this.loading = false\r\n    },\r\n    playHistorySong () {\r\n      // 将该歌单里的的所有歌曲信息添加到vuex 相应数据并且把\r\n      // 播放的歌曲 singleSongMsg设置为该歌单第一首歌\r\n      // 而且对第一首歌进行MP3url请求\r\n      if (this.hislistSongMsg.length === 0) return\r\n      this.$store.commit(\"songDetail/setSongList\", this.hislistSongMsg)\r\n      this.$store.dispatch('songDetail/getoneMusic', this.hislistSongMsg[0])\r\n    },\r\n    async getLikeIdList (uid) {\r\n      const res = await getLikeIdList(uid)\r\n      this.likeIdList = res.data.ids\r\n    },\r\n    isLiked (id) {\r\n      return this.likeIdList.indexOf(id) !== -1\r\n    },\r\n    async likeMusic (item) {\r\n      item.isLiked = !item.isLiked\r\n      await likeMusic(item.id, item.isLiked)\r\n    }\r\n  },\r\n  created () {\r\n    // 将本地localhitorylist数据进行截取\r\n    this.changHistoryList()\r\n  },\r\n  computed: {\r\n    uid () {\r\n      return this.$store.state.login.profile.userId\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\" >\r\n.HistoryPlay {\r\n  .info {\r\n    display: flex;\r\n    justify-content: space-between;\r\n    align-items: center;\r\n  }\r\n  .el-table__cell {\r\n    div.cell {\r\n      white-space: nowrap;\r\n    }\r\n  }\r\n}\r\n</style>","import mod from \"-!../../../node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/_thread-loader@2.1.3@thread-loader/dist/cjs.js!../../../node_modules/_babel-loader@8.2.3@babel-loader/lib/index.js!../../../node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/_vue-loader@15.9.8@vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/_thread-loader@2.1.3@thread-loader/dist/cjs.js!../../../node_modules/_babel-loader@8.2.3@babel-loader/lib/index.js!../../../node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/_vue-loader@15.9.8@vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./index.vue?vue&type=template&id=a470cff2&\"\nimport script from \"./index.vue?vue&type=script&lang=js&\"\nexport * from \"./index.vue?vue&type=script&lang=js&\"\nimport style0 from \"./index.vue?vue&type=style&index=0&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/_vue-loader@15.9.8@vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}